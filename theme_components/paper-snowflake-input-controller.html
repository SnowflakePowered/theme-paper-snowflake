<link rel="import" href="paper-snowflake-dynamic-input-set">
<link rel="import" href="paper-snowflake-controller-selector">
<link rel="import" href="paper-snowflake-profile-selector">
<link rel="import" href="../bower_components/paper-button/paper-button">

<polymer-element name="paper-snowflake-input-controller" attributes="selectedController availableControllers availableProfiles">
<template>
  <style>
    .controller-menu {
      display: table;
      position: relative;
      width: 100%;
    }
    .controller-selector {
      display: table-cell;
      width: calc(100% - 30px);
    }
    .controller-buttons {
      display: table-cell;
      width: 30px;
    }
  </style>
  <div class="controller-menu">
    <div class="controller-selector">
      <paper-snowflake-controller-selector availableControllers="{{availableControllers}}" selectedController="{{selectedController}}"></paper-snowflake-controller-selector>
      <paper-snowflake-profile-selector hidden?="{{!controllerSelected}}" availableProfiles="{{availableProfiles}}" selectedProfile="{{selectedProfile}}" seletcedProfileName="{{selectedProfileName}}"></paper-snowflake-profile-selector>
    </div>
    <div class="controller-buttons">
      <paper-button>Save</paper-button>
    </div>
  </div>
  <div class="inputs" hidden?="{{!profileSelected}}">
    <paper-snowflake-dynamic-input-set on-input-changed="{{inputChanged}}" controller="{{selectedController}}" profile="{{selectedProfile}}" profileName="{{selectedProfileName}}"></paper-snowflake-dynamic-input-set>
  </div>
  <div class="placeholder" hidden?="{{profileSelected}}">
    Select a profile
  </div>
</template>
<script>
  Polymer('paper-snowflake-input-controller', {

    ready: function () {
      window.p = this;
      this.profileSelected = false;
      this.controllerSelected = false;
    },
    availableProfilesChanged: function(){
      if (Object.getOwnPropertyNames(this.selectedController).length === 0 || Object.getOwnPropertyNames(this.availableProfiles).length === 0){
        this.controllerSelected = false;
      }else{
        this.controllerSelected = true;
      }
    },
    selectedProfileChanged: function(){
      if (this.selectedProfile === undefined){
        this.profileSelected = false;
      }else{
        this.profileSelected = true;
      }
    },
    inputChanged: function(e){
      if(this.profileSelected) {
        console.log("input changed"); //todo do somethign ehre
      }
    },


  });
</script>
</polymer-element>
